# 債券指數成分資料類別

這個 Python 模組實現了一個用於表示債券指數成分資料的類別，包含債券的所有相關資訊。

## 功能特色

- **完整的資料結構**: 包含債券基本資訊、指數資訊、價格收益資訊、市場資料和日期資訊
- **資料驗證**: 內建資料合理性驗證，確保資料品質
- **友善的顯示**: 提供格式化的字符串輸出，方便檢視資料
- **靈活的資料格式**: 支援字典格式轉換，便於資料交換
- **實用的計算方法**: 提供距離到期日計算、權重百分比等實用功能

## 類別結構

### BondIndexComponent 類別

包含以下欄位類別：

#### 1. 債券基本資訊
- `bond_name`: 債券名稱
- `isin`: ISIN國際證券識別號碼
- `issuer`: 發行人
- `credit_rating`: 信用評級
- `maturity_date`: 到期日

#### 2. 指數相關資訊
- `index_name`: 指數名稱
- `weight_in_index`: 指數中的權重 (0-1之間的小數)

#### 3. 價格與收益相關資訊
- `bond_price`: 債券價格
- `yield_rate`: 殖利率
- `yield_to_maturity`: 到期收益率
- `duration`: 期間

#### 4. 市場資料
- `market_value`: 市場價值
- `trading_volume`: 交易量

#### 5. 日期資訊
- `data_date`: 資料日期

## 使用方式

### 基本用法

```python
from datetime import datetime
from bond_index_component import BondIndexComponent

# 創建債券資料實例
bond = BondIndexComponent(
    # 債券基本資訊
    bond_name="台灣政府公債 2030",
    isin="TW0000012345",
    issuer="中華民國政府",
    credit_rating="AA+",
    maturity_date=datetime(2030, 12, 31),
    
    # 指數相關資訊
    index_name="台灣政府債券指數",
    weight_in_index=0.025,  # 2.5%
    
    # 價格與收益相關資訊
    bond_price=102.50,
    yield_rate=0.0275,  # 2.75%
    yield_to_maturity=0.0280,  # 2.80%
    duration=6.25,
    
    # 市場資料
    market_value=1025000000,  # 10.25億
    trading_volume=50000000,  # 5千萬
    
    # 日期資訊
    data_date=datetime(2024, 9, 24)
)

# 顯示債券資料
print(bond)

# 獲取額外資訊
print(f"距離到期日: {bond.get_days_to_maturity()} 天")
print(f"權重百分比: {bond.get_weight_percentage()}")

# 轉換為字典格式
bond_dict = bond.to_dict()
```

### 輸出範例

執行上述程式碼會產生以下輸出：

```
=== 債券指數成分資料 ===
資料日期: 2024-09-24

【債券基本資訊】
債券名稱: 台灣政府公債 2030
ISIN: TW0000012345
發行人: 中華民國政府
信用評級: AA+
到期日: 2030-12-31

【指數相關資訊】
指數名稱: 台灣政府債券指數
指數權重: 2.5000%

【價格與收益資訊】
債券價格: 102.50
殖利率: 2.7500%
到期收益率: 2.8000%
期間: 6.25

【市場資料】
市場價值: 1,025,000,000.00
交易量: 50,000,000

距離到期日: 2289 天
權重百分比: 2.50%
```

## 方法說明

### 主要方法

- `__init__(...)`: 初始化債券資料，包含所有必要欄位
- `__str__()`: 返回格式化的債券資料字符串，方便閱讀
- `__repr__()`: 返回物件的程式碼表示
- `to_dict()`: 將債券資料轉換為字典格式
- `get_days_to_maturity()`: 計算距離到期日的天數
- `get_weight_percentage()`: 獲取權重的百分比字符串表示

### 資料驗證

類別包含內建的資料驗證機制：

- 權重必須在 0 到 1 之間
- 債券價格必須大於 0
- 市場價值必須大於 0
- 交易量不能為負數
- 期間不能為負數

如果資料不符合要求，會拋出 `ValueError` 異常。

## 範例應用場景

1. **債券組合分析**: 用於分析債券組合的成分和權重分佈
2. **風險管理**: 計算債券組合的期間、殖利率等風險指標
3. **報表生成**: 生成債券指數成分報表
4. **資料交換**: 與其他系統交換債券資料（透過字典格式）
5. **投資決策**: 提供完整的債券資訊供投資決策參考

## 檔案結構

```
PROGRAM/python/
├── bond_index_component.py    # 主要類別實現
└── README.md                  # 此說明文件
```

## 依賴套件

- `datetime`: Python 內建模組，用於處理日期時間
- `typing`: Python 內建模組，用於類型註解

無需安裝額外套件即可使用。

## 注意事項

- 所有日期參數應使用 `datetime.datetime` 物件
- 權重和收益率使用小數表示（例如：0.025 代表 2.5%）
- 金額單位由使用者自行定義（建議使用相同單位）
- ISIN 代碼應遵循國際標準格式